<% ValidOptionsChecker.call(@options, %i[rates]) %>

<h1>Films#index</h1>

<% if can? :manage, Film.new %>
  <%= link_to 'add new film', new_film_path %>
<% end %>

<%= form_tag films_path, method: :get do %>
  <%= select_tag :category, 
        options_for_select(
          @options[:film_select_options],
          @options[:filtering_category]), 
        include_blank: true %>
  <%= submit_tag 'filter' %>
<% end %>

<%= paginate @films, theme: 'bootstrap-5' %>

  <% @films.each do |film| %>
    <%= render 'films/shared/film', local_options: { 
          film:   film,
          rate:   @options[:rates][:"#{film.id}"][:rate],
          rated?: @options[:rates][:"#{film.id}"][:rated?]
        } %>
  <% end %>

<%= paginate @films, theme: 'bootstrap-5' %>
